<%@page import="basic.MemberDAO"%>
<%@page import="java.util.ArrayList"%>
<%@page import="java.util.List"%>
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
</head>
<body>
<script>
		function msgGo(msg, url){
			alert(msg);
			location.href=url;
		}
	</script>
	<%
	
	String id=request.getParameter("loginId");
	String pw=request.getParameter("loginPw");
	
	int idIdx=MemberDAO.getInstance().checkId(id);
	int pwIdx=MemberDAO.getInstance().checkPw(pw);
	
	if(idIdx==-1 || pwIdx==-1){
		%>
		<script>msgGo("로그인 실패","03_21_loginForm.jsp")</script>
		<%
	}
	
	
	if(idlist.contains(loginId)){
		int tempIdx=idlist.indexOf(loginId);
		if(pwlist.get(tempIdx).equals(loginPw)){
			idx=tempIdx;
		}
	}
	if(idx==-1){
		%>
		<script>msgGo("로그인 실패","03_21_loginForm.jsp")</script>
		<%
	}else{
		session.setAttribute("idx",idx );
		if(idlist.get(idx).equals("admin")){
			%>
			<script>msgGo("관리자 로그인 성공","01_11_adminMain.jsp")</script>
		<%
		}else{
			%>
			<script>msgGo("<%=loginId%>님 로그인 성공","02_main.jsp")</script>
			<%
		}
	}
	
	%>

</body>
</html>